import React, { useEffect, useRef, useState } from "react";
import {
  Menu,
  Bell,
  ShoppingCart,
  Search,
  ShoppingBag,
  LayoutGrid,
  User,
  ChevronLeft,
  Store,
} from "lucide-react";

interface Props {
  className?: string;
}

const SheinHome: React.FC<Props> = ({ className = "" }) => {
  // Data
  const categories = [
    { name: "فساتين", image: "https://csspicker.dev/api/image/?q=dress&image_type=photo" },
    { name: "أحذية", image: "https://csspicker.dev/api/image/?q=shoes+footwear&image_type=photo" },
    { name: "حقائب", image: "https://csspicker.dev/api/image/?q=handbag&image_type=photo" },
    { name: "ملابس رياضية", image: "https://csspicker.dev/api/image/?q=sportswear&image_type=photo" },
    { name: "إكسسوارات", image: "https://csspicker.dev/api/image/?q=fashion+accessories&image_type=photo" },
    { name: "مجوهرات", image: "https://csspicker.dev/api/image/?q=jewelry&image_type=photo" },
    { name: "أزياء نسائية", image: "https://csspicker.dev/api/image/?q=women+fashion&image_type=photo" },
    { name: "أزياء رجالية", image: "https://csspicker.dev/api/image/?q=men+fashion&image_type=photo" },
    { name: "أزياء الأطفال", image: "https://csspicker.dev/api/image/?q=kids+fashion&image_type=photo" },
    { name: "جمال وصحة", image: "https://csspicker.dev/api/image/?q=beauty+cosmetics&image_type=photo" },
    { name: "منزل وحديقة", image: "https://csspicker.dev/api/image/?q=home+garden&image_type=photo" },
    { name: "بلوزات", image: "https://csspicker.dev/api/image/?q=blouse&image_type=photo" },
    { name: "تنورات", image: "https://csspicker.dev/api/image/?q=skirt&image_type=photo" },
    { name: "معاطف", image: "https://csspicker.dev/api/image/?q=coat&image_type=photo" },
    { name: "جينز", image: "https://csspicker.dev/api/image/?q=jeans&image_type=photo" },
  ];

  const bigDeals = [
    { image: "https://csspicker.dev/api/image/?q=black+midi+dress&image_type=photo", price: "179.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=brown+dress+model&image_type=photo", price: "179.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=white+dress&image_type=photo", price: "179.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=black+sleeveless+dress&image_type=photo", price: "179.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=beige+skirt&image_type=photo", price: "95.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=pink+top&image_type=photo", price: "48.00 ر.س" },
  ];

  const hotTrends = [
    { image: "https://csspicker.dev/api/image/?q=black+skirt&image_type=photo", price: "66.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=white+blouse&image_type=photo", price: "95.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=white+summer+dress&image_type=photo", price: "159.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=black+blouse&image_type=photo", price: "79.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=leather+handbag&image_type=photo", price: "129.00 ر.س" },
    { image: "https://csspicker.dev/api/image/?q=white+sneakers&image_type=photo", price: "139.00 ر.س" },
  ];

  const promoTiles = [
    { title: "شحن مجاني", sub: "للطلبات فوق 99 ر.س", image: "https://csspicker.dev/api/image/?q=free+shipping+icon&image_type=photo", bg: "#ffffff" },
    { title: "خصم 90%", sub: "لفترة محدودة", image: "https://csspicker.dev/api/image/?q=sale+tag&image_type=photo", bg: "#fff6f1" },
    { title: "الدفع عند الاستلام", sub: "متاح لمدن مختارة", image: "https://csspicker.dev/api/image/?q=cod+payment&image_type=photo", bg: "#f7faff" },
    { title: "نقاط ومكافآت", sub: "اكسب مع كل شراء", image: "https://csspicker.dev/api/image/?q=reward+points&image_type=photo", bg: "#f9f9ff" },
    { title: "خصم الطلاب", sub: "تحقق من الأهلية", image: "https://csspicker.dev/api/image/?q=student+discount&image_type=photo", bg: "#fffaf3" },
    { title: "عروض اليوم", sub: "لا تفوّت الفرصة", image: "https://csspicker.dev/api/image/?q=deal+of+the+day&image_type=photo", bg: "#f5fffb" },
  ];

  const midPromo = {
    image: "https://images.unsplash.com/photo-1512203492609-8b0f0b52f483?w=1600&q=60",
    alt: "عرض شريطي 90×720",
    text: "قسائم إضافية + شحن مجاني",
  };

  // UI state
  const [scrolled, setScrolled] = useState(false);
  const [activeTab, setActiveTab] = useState(0);
  const tabs = ["كل", "نساء", "رجال", "أطفال", "أحجام كبيرة", "جمال", "المنزل", "أحذية", "فساتين"];
  const tabsRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const onScroll = () => setScrolled(window.scrollY > 60);
    onScroll();
    window.addEventListener("scroll", onScroll, { passive: true });
    return () => window.removeEventListener("scroll", onScroll);
  }, []);

  const onTabsKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === "ArrowRight") setActiveTab((a) => Math.min(a + 1, tabs.length - 1));
    if (e.key === "ArrowLeft") setActiveTab((a) => Math.max(a - 1, 0));
    const el = tabsRef.current?.children[activeTab] as HTMLElement | undefined;
    el?.scrollIntoView({ inline: "center", behavior: "smooth" });
  };

  // بلاط مبسّط للصورة + السعر فقط
  const SimpleTile = ({ image, price }: { image: string; price: string }) => (
    <button className="text-start snap-item simple-item" aria-label={`منتج بسعر ${price}`}>
      <div className="border border-gray-200 rounded-[4px] overflow-hidden bg-white">
        <img src={image} alt={price} className="w-full aspect-[255/192] object-cover" loading="lazy" />
      </div>
      <div className="mt-1">
        <span className="text-red-600 font-bold text-sm">{price}</span>
      </div>
    </button>
  );

// بطاقة المنتج
const ProductCard = ({
  image,
  overlayBannerSrc,
  overlayBannerAlt,
  title,
  brand,
  discountPercent,
  bestRank,
  bestRankCategory,
  basePrice,
  soldPlus,
  couponPrice,
  colors,
  colorCount,
  imageAspect = "aspect-[4/5]", // ⚡ هنا تتحكم بنسبة أبعاد الصورة (غيّرها مثلاً aspect-square لمربع)
}: {
  image: string;
  overlayBannerSrc?: string;
  overlayBannerAlt?: string;
  title: string;
  brand?: string;
  discountPercent?: number;
  bestRank?: number;
  bestRankCategory?: string;
  basePrice?: string;
  soldPlus?: string;
  couponPrice?: string;
  colors?: string[];
  colorCount?: number;
  imageAspect?: string;
}) => {
  // 🎨 ألوان معرفة مسبقاً (يمكنك تغيير الأكواد هنا لتغيير الثيم)
  const purple = "#6D28D9"; // بنفسجي
  const graySegment = "#F3F4F6"; // رمادي فاتح
  const grayText = "#374151"; // رمادي غامق
  const orangeText = "#F97316"; // برتقالي للنص
  const orangeBorder = "#FB923C"; // برتقالي للحدود
  const yellowDark = "#F59E0B"; // أصفر غامق
  const yellowLight = "#FEF3C7"; // أصفر فاتح

  return (
    <div className="masonry-item">
      {/* 🟦 الحاوية الرئيسية للبطاقة */}
      <div className="w-full border border-gray-200 rounded-[4px] bg-white overflow-hidden">
        
        {/* 🖼️ صورة المنتج */}
        <div className={`relative w-full ${imageAspect}`}>
          <img
            src={image}
            alt={title}
            className="absolute inset-0 w-full h-full object-cover" 
            loading="lazy"
          />

          {/* 🎨 عمود الألوان وعددها */}
          {(colors?.length || typeof colorCount === "number") && (
            <div className="absolute bottom-2 right-2 flex flex-col items-center">
            <div className="flex flex-col items-center gap-0.5 bg-black/40 p-0.5 rounded-full">
            {colors?.slice(0, 3).map((c, idx) => (
              <span
              key={`clr-${idx}`}
              className="w-3 h-3 rounded-full border border-white/20"
              style={{ backgroundColor: c }}
              />
              ))}
              {typeof colorCount === "number" && (
                <span className="mt-0.5 text-[9px] font-medium px-1 py-0.5 rounded-full text-white/80 bg-white/5">
                {colorCount}
                </span>
                )}
                </div>
                </div>
                )}
                </div>

        {/* 📢 شريط تسويقي أسفل الصورة */}
        {overlayBannerSrc && (
          <div className="w-full h-7 relative">
            <img
              src={overlayBannerSrc}
              alt={overlayBannerAlt || "شريط تسويقي"}
              className="absolute inset-0 w-full h-full object-cover"
              loading="lazy"
            />
          </div>
        )}

        {/* 📦 المحتوى السفلي */}
        <div className="px-2 py-2 relative">
          
          {/* 🔝 شريط ترندات + المتجر */}
          <div className="inline-flex items-center rounded-[4px] overflow-hidden border border-gray-200">
            {/* ترندات */}
            <button
              className="inline-flex items-center px-2 text-[11px] font-semibold text-white rounded-[4px]"
              style={{ backgroundColor: purple }}
            >
              ترندات
            </button>
            {/* المتجر: أيقونة حديثة فارغة وبنفسجية */}
            <button
              className="inline-flex items-center gap-1 px-2 text-[11px] font-medium rounded-[4px]"
              style={{ backgroundColor: graySegment, color: purple }}
              aria-label={`رموز متجر ${brand || ""}`}
            >
              <Store className="w-3.5 h-3.5" color={purple} strokeWidth={2} />
              <span className="line-clamp-1">{brand || ""}</span>
              <span style={{ color: purple }}>{">"}</span>
            </button>
          </div>

          {/* 🏷️ مربع الخصم + اسم المنتج */}
          <div className="mt-0.5 flex items-center gap-1.5">
            {typeof discountPercent === "number" && (
              <div
                className="px-1 h-4 rounded-[3px] text-[11px] font-semibold border flex items-center leading-[1.1]"
                style={{
                  borderColor: orangeBorder,
                  color: orangeText,
                }}
              >
                -%{discountPercent}
              </div>
            )}
            <div className="text-[12px] text-gray-900 font-medium line-clamp-1 leading-[1.15]">
              {title}
            </div>
          </div>

          {/* ⭐ الأفضل مبيعاً */}
          {(typeof bestRank === "number" || bestRankCategory) && (
            <div className="mt-0.5 inline-flex items-stretch rounded-[4px] overflow-hidden">
              {typeof bestRank === "number" && (
                <div
                  className="px-1 text-[9px] font-medium flex items-center leading-[1.1]"
                  style={{
                    backgroundColor: "rgba(255, 232, 174)",
                    color: '#c77210',
                  }}
                >
                  #{bestRank} الأفضل مبيعاً
                </div>
              )}
              {bestRankCategory && (
                <button
                  className="px-1 text-[9px] font-semibold flex items-center gap-1 leading-[1.1]"
                  style={{
                    backgroundColor: "rgba(254, 243, 199, 0.2)",
                    color: '#d58700',
                    borderLeft: 0,
                  }}
                  aria-label={`اذهب إلى الفئة ${bestRankCategory}`}
                >
                  <span>في {bestRankCategory}</span>
                  <span>{">"}</span>
                </button>
              )}
            </div>
          )}

          {/* 💰 السعر الأساسي + تم البيع (زر السلة مستقل ومثبت أسفل يمين المحتوى) */}
          {(basePrice || soldPlus) && (
            <div className="mt-0.5 flex items-center gap-1.5">
              {basePrice && (
                <span
                  className="text-[13px] font-bold leading-[1.1]"
                  style={{ color: orangeText }}
                >
                  {basePrice} ريال
                </span>
              )}
              {soldPlus && (
                <span className="text-[11px] text-gray-700 leading-[1.1]">{soldPlus}</span>
              )}
            </div>
          )}

          {/* 🛒 زر السلة: مستقل عن الأسطر، موضوع بشكل مطلق */}
          {(basePrice || soldPlus) && (
            <button
              className="absolute left-2 bottom-6 flex items-center gap-1 px-2 py-1 rounded-full border bg-white border-black"
              aria-label="أضف إلى السلة"
            >
              <ShoppingCart className="w-4 h-4 text-black" />
              <span className="text-[11px] font-semibold text-black">
                1+
              </span>
            </button>
          )}

          {/* 🎟️ السعر بعد الكوبون */}
          {couponPrice && (
            <div
              className="mt-0.5 h-7 inline-flex items-center gap-1 px-2 rounded-[3px]"
              style={{
                backgroundColor: "rgba(249, 115, 22, 0.10)",
              }}
            >
              <span
                className="text-[13px] font-extrabold leading-[1.1]"
                style={{ color: orangeText }}
              >
                {couponPrice} ريال
              </span>
              <span className="text-[11px]" style={{ color: orangeText }}>
                /بعد الكوبون
              </span>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

  // من أجلك: بيانات مطابقة للصورة
  const forYou = [
    {
      image: "https://csspicker.dev/api/image/?q=black+dress+model&image_type=photo",
      overlayBannerSrc: "https://csspicker.dev/api/image/?q=anniversary+party+banner+pink+yellow&image_type=photo",
      overlayBannerAlt: "حفلة الذكرى السنوية",
      title: "COSMINA ملابس علوية كا ...",
      brand: "COSMINA",
      discountPercent: 25,
      bestRank: 4,
      bestRankCategory: "أنيق قمم نسائية",
      basePrice: "21.06",
      soldPlus: "تم بيع 100+",
      couponPrice: "16.85",
      colors: ["#111111", "#6B7280", "#EEE5D4", "#F9A8D4"],
      colorCount: 9,
      imageAspect: "aspect-[4/5]",
    },
    {
      image: "https://csspicker.dev/api/image/?q=sleeveless+top+black+white&image_type=photo",
      overlayBannerSrc: "https://csspicker.dev/api/image/?q=anniversary+party+banner+pink+yellow&image_type=photo",
      overlayBannerAlt: "حفلة الذكرى السنوية",
      title: "بلوزة نسائية بدون كم، خصر مرتفع",
      brand: "Frierie CURVE",
      discountPercent: 76,
      basePrice: "120.00",
      soldPlus: "تم بيع 410+",
      couponPrice: "29.00",
      colors: ["#000000", "#FFFFFF", "#A3A3A3", "#FECACA"],
      colorCount: 6,
      imageAspect: "aspect-[5/4]",
    },
    {
      image: "https://csspicker.dev/api/image/?q=casual+shirt+dazy&image_type=photo",
      overlayBannerSrc: "https://csspicker.dev/api/image/?q=anniversary+party+banner+pink+yellow&image_type=photo",
      overlayBannerAlt: "حفلة الذكرى السنوية",
      title: "قميص بجيوب نسائي بسيط",
      brand: "Dazy",
      basePrice: "120.00",
      couponPrice: "69.00",
      colors: ["#FFFFFF", "#9CA3AF", "#E5E7EB", "#FDE68A"],
      colorCount: 3,
      imageAspect: "aspect-[3/4]",
    },
    {
      image: "https://csspicker.dev/api/image/?q=white+outfit+woman+outdoor&image_type=photo",
      overlayBannerSrc: "https://csspicker.dev/api/image/?q=anniversary+party+banner+pink+yellow&image_type=photo",
      overlayBannerAlt: "حفلة الذكرى السنوية",
      title: "إطلالة أنيقة بيضاء",
      basePrice: "159.00",
      colors: ["#FFFFFF", "#F3F4F6", "#D1D5DB", "#A7F3D0"],
      colorCount: 5,
      imageAspect: "aspect-[3/4]",
    },
  ];

  const headerH = scrolled ? 48 : 64;

  // Categories: 3 rows horizontally scrollable
  const rows = 3;
  const perRow = Math.ceil(categories.length / rows);
  const catRows = Array.from({ length: rows }, (_, i) =>
    categories.slice(i * perRow, (i + 1) * perRow)
  );

  return (
    <div className={`min-h-screen bg-[#f7f7f7] ${className}`} dir="rtl">
      <style>{`
        .no-scrollbar { scrollbar-width: none; -ms-overflow-style: none; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .snap-x-start { scroll-snap-type: x mandatory; }
        .snap-item { scroll-snap-align: start; }

        /* الفئات: إظهار 4.7 عنصر بدقة مع gap = 12px */
        .cat-row { --visible: 4.7; --gap: 12px; }
        .cat-row-inner { display: flex; gap: var(--gap); }
        .cat-item { flex: 0 0 calc((100% - (var(--visible) - 1) * var(--gap)) / var(--visible)); }

        /* كروسات “عروض كبرى/أهم الترندات” */
        .simple-row { --visible: 4.15; --gap: 6px; }
        .simple-row-inner { display: flex; gap: var(--gap); }
        .simple-item { flex: 0 0 calc((100% - (var(--visible) - 1) * var(--gap)) / var(--visible)); }

        /* Masonry لمن أجلك: بدون فراغات عمودية بين البطاقات */
        .masonry { column-count: 2; column-gap: 6px; }
        .masonry-item { break-inside: avoid; margin-bottom: 6px; display: inline-block; width: 100%; }
      `}</style>

      {/* Header */}
      <div
        className={`fixed top-0 left-0 right-0 z-50 transition-all duration-200 ${
          scrolled ? "bg-white/95 backdrop-blur-sm h-12" : "bg-transparent h-16"
        }`}
        aria-label="رأس الصفحة"
      >
        <div className="max-w-md mx-auto h-full px-3 flex items-center justify-between">
          <div className="flex items-center gap-1">
            <button className="w-11 h-11 flex items-center justify-center rounded-[4px]" aria-label="القائمة">
              <Menu className={`w-6 h-6 ${scrolled ? "text-gray-800" : "text-white"}`} />
            </button>
            <button className="w-11 h-11 flex items-center justify-center rounded-[4px]" aria-label="الإشعارات">
              <Bell className={`w-6 h-6 ${scrolled ? "text-gray-800" : "text-white"}`} />
            </button>
          </div>
          <div className={`text-base font-semibold ${scrolled ? "text-gray-900" : "text-white"}`} aria-label="شعار المتجر">
            jeeey
          </div>
          <div className="flex items-center gap-1">
            <button className="w-11 h-11 flex items-center justify-center rounded-[4px]" aria-label="السلة">
              <ShoppingCart className={`w-6 h-6 ${scrolled ? "text-gray-800" : "text-white"}`} />
            </button>
            <button className="w-11 h-11 flex items-center justify-center rounded-[4px]" aria-label="البحث">
              <Search className={`w-6 h-6 ${scrolled ? "text-gray-800" : "text-white"}`} />
            </button>
          </div>
        </div>
      </div>

      {/* TabsBar */}
      <div
        className={`${scrolled ? "bg-white/95 backdrop-blur-sm" : "bg-transparent"} fixed left-0 right-0 z-40 transition-colors`}
        style={{ top: headerH }}
        role="tablist"
        aria-label="التبويبات"
      >
        <div
          ref={tabsRef}
          className="max-w-md mx-auto overflow-x-auto no-scrollbar px-3 py-2 flex gap-4"
          onKeyDown={onTabsKeyDown}
        >
          {tabs.map((t, i) => (
            <button
              key={t}
              role="tab"
              aria-selected={activeTab === i}
              tabIndex={0}
              onClick={() => setActiveTab(i)}
              className={`text-sm whitespace-nowrap relative pb-1 ${
                activeTab === i ? "text-black font-semibold" : scrolled ? "text-gray-700" : "text-white"
              }`}
            >
              {t}
              <span
                className={`absolute left-0 right-0 -bottom-0.5 h-0.5 transition-all ${
                  activeTab === i ? (scrolled ? "bg-black" : "bg-white") : "bg-transparent"
                }`}
              />
            </button>
          ))}
        </div>
      </div>

      {/* Banner */}
      <div className="max-w-md mx-auto">
        <div className="relative w-full h-[360px] sm:h-[420px]">
          <img
            src="https://images.unsplash.com/photo-1512436991641-6745cdb1723f?w=1200&q=60"
            srcSet="https://images.unsplash.com/photo-1512436991641-6745cdb1723f?w=1200&q=60&fm=webp 1200w, https://images.unsplash.com/photo-1512436991641-6745cdb1723f?w=2400&q=60&fm=webp 2400w"
            alt="عرض تخفيضات"
            className="absolute inset-0 w-full h-full object-cover"
            loading="eager"
          />
          <div className="absolute inset-0 bg-gradient-to-b from-black/50 via-black/20 to-transparent pointer-events-none" />
          <div className="absolute bottom-4 right-4 left-4 text-white">
            <div className="text-sm mb-1">احتفالنا الأكبر على الإطلاق</div>
            <div className="text-4xl sm:text-5xl font-extrabold leading-tight">خصم يصل حتى 90%</div>
            <button className="mt-3 bg-white text-black px-4 py-2 rounded-[4px] text-sm font-semibold" aria-label="تسوّق الآن">
              تسوّق الآن
            </button>
          </div>
        </div>
      </div>

      {/* شريط عروض ترويجية تحت الـ Banner */}
      <section className="max-w-md mx-auto px-3 py-3">
        <div className="bg-white border border-gray-200 rounded-[4px] px-3 py-3">
          <div className="overflow-x-auto no-scrollbar snap-x-start flex gap-1.5" aria-label="عروض ترويجية أفقية">
            {promoTiles.map((item) => (
              <div
                key={item.title}
                className="snap-item w-[192px] h-[68px] flex-shrink-0 rounded-[4px] border border-gray-200 relative overflow-hidden"
                style={{ backgroundColor: item.bg }}
              >
                <img
                  src={item.image}
                  alt={item.title}
                  className="absolute right-0 top-0 w-16 h-full object-cover opacity-90"
                  loading="lazy"
                />
                <div className="absolute inset-y-0 left-2 right-20 flex flex-col justify-center">
                  <div className="text-[12px] font-semibold text-gray-900">{item.title}</div>
                  <div className="text-[11px] text-gray-600">{item.sub}</div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>

      {/* صورة شريطية 90×720 */}
      <div className="max-w-md mx-auto px-3 py-3">
        <div className="w-full h-[90px] rounded-[4px] overflow-hidden relative border border-gray-200 bg-white">
          <img
            src={midPromo.image}
            alt={midPromo.alt}
            className="absolute inset-0 w-full h-full object-cover"
            loading="lazy"
          />
          <div className="absolute inset-0 bg-black/10" />
          <div className="absolute right-3 left-3 top-1/2 -translate-y-1/2 text-white text-[12px] font-semibold">
            {midPromo.text}
          </div>
        </div>
      </div>

      {/* Content */}
      <div className="max-w-md mx-auto">
        {/* Categories */}
        <section className="px-3 py-3" aria-label="الفئات">
          <div className="bg-white border border-gray-200 rounded-[4px] px-3 py-3">
            <h2 className="text-sm font-semibold text-gray-900 mb-2">الفئات</h2>
            {catRows.map((row, idx) => (
              <div key={idx} className="overflow-x-auto no-scrollbar snap-x-start mb-1.5 cat-row">
                <div className="cat-row-inner">
                  {row.map((c) => (
                    <button
                      key={`${c.name}-${idx}`}
                      className="snap-item cat-item text-center"
                      aria-label={`فئة ${c.name}`}
                    >
                      <div className="w-[68px] h-[68px] rounded-full overflow-hidden mx-auto mb-1.5 border border-gray-200 bg-white">
                        <img src={c.image} alt={c.name} className="w-full h-full object-cover" loading="lazy" />
                      </div>
                      <div className="text-[11px] text-gray-700 line-clamp-2">{c.name}</div>
                    </button>
                  ))}
                </div>
              </div>
            ))}
          </div>
        </section>

        {/* عروض كبرى */}
        <section className="px-3 py-3" aria-label="عروض كبرى">
          <div className="bg-white border border-gray-200 rounded-[4px] px-3 py-3">
            <div className="mb-1.5 flex items-center justify-between">
              <h2 className="text-sm font-semibold text-gray-900">عروض كبرى</h2>
              <button className="flex items-center text-xs text-gray-700" aria-label="عرض المزيد في عروض كبرى">
                <span className="mr-1">المزيد</span>
                <ChevronLeft className="w-4 h-4" />
              </button>
            </div>
            <div className="overflow-x-auto no-scrollbar snap-x-start simple-row">
              <div className="simple-row-inner">
                {bigDeals.map((p, i) => (
                  <SimpleTile key={`deal-${i}`} image={p.image} price={p.price} />
                ))}
              </div>
            </div>
          </div>
        </section>

        {/* أهم الترندات */}
        <section className="px-3 py-3" aria-label="أهم الترندات">
          <div className="bg-white border border-gray-200 rounded-[4px] px-3 py-3">
            <div className="mb-1.5 flex items-center justify-between">
              <h2 className="text-sm font-semibold text-gray-900">أهم الترندات</h2>
              <button className="flex items-center text-xs text-gray-700" aria-label="عرض المزيد في أهم الترندات">
                <span className="mr-1">المزيد</span>
                <ChevronLeft className="w-4 h-4" />
              </button>
            </div>
            <div className="overflow-x-auto no-scrollbar snap-x-start simple-row">
              <div className="simple-row-inner">
                {hotTrends.map((p, i) => (
                  <SimpleTile key={`trend-${i}`} image={p.image} price={p.price} />
                ))}
              </div>
            </div>
          </div>
        </section>

        {/* من أجلك: Masonry ببطاقة مطابقة للصورة */}
        <section className="px-3 py-3" aria-label="من أجلك">
          <div className="bg-white border border-gray-200 rounded-[4px] px-3 py-3">
            <h2 className="text-sm font-semibold text-gray-900 text-center">من أجلك</h2>
          </div>

          <div className="mt-0 masonry">
            {forYou.map((p, i) => (
              <ProductCard
                key={`fy-${i}`}
                image={p.image}
                overlayBannerSrc={p.overlayBannerSrc}
                overlayBannerAlt={p.overlayBannerAlt}
                title={p.title}
                brand={p.brand}
                discountPercent={p.discountPercent}
                bestRank={p.bestRank}
                bestRankCategory={p.bestRankCategory}
                basePrice={p.basePrice}
                soldPlus={p.soldPlus}
                couponPrice={p.couponPrice}
                colors={p.colors}
                colorCount={p.colorCount}
                imageAspect={p.imageAspect}
              />
            ))}
          </div>

          <div className="mt-4" />
        </section>

        <div className="h-20" />
      </div>

      {/* BottomNav */}
      <nav className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50" aria-label="التنقل السفلي">
        <div className="max-w-md mx-auto flex justify-around py-2" dir="rtl">
          <button className="text-center w-16" aria-label="الرئيسية">
            <LayoutGrid className="w-6 h-6 mx-auto mb-1 text-black" />
            <div className="text-[11px] text-black">الرئيسية</div>
          </button>
          <button className="text-center w-16" aria-label="الفئات">
            <LayoutGrid className="w-6 h-6 mx-auto mb-1 text-gray-700" />
            <div className="text-[11px] text-gray-700">الفئات</div>
          </button>
          <button className="text-center w-16" aria-label="جديد/بحث">
            <Search className="w-6 h-6 mx-auto mb-1 text-gray-700" />
            <div className="text-[11px] text-gray-700">جديد</div>
          </button>
          <button className="text-center w-16" aria-label="حقيبة التسوق">
            <ShoppingBag className="w-6 h-6 mx-auto mb-1 text-gray-700" />
            <div className="text-[11px] text-gray-700">الحقيبة</div>
          </button>
          <button className="text-center w-16" aria-label="حسابي">
            <User className="w-6 h-6 mx-auto mb-1 text-gray-700" />
            <div className="text-[11px] text-gray-700">حسابي</div>
          </button>
        </div>
      </nav>
    </div>
  );
};

export default SheinHome;
