(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{4499:function(e,r,t){Promise.resolve().then(t.bind(t,7944))},7944:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return l},dynamic:function(){return d}});var n=t(875),o=t(5393),i=t(5009);let d="force-dynamic";function l(){let e=o.useMemo(()=>i.env.NEXT_PUBLIC_API_BASE_URL||window.location.origin.replace("jeeey-manger","jeeeyai"),[]),r=o.useCallback(()=>{if("undefined"==typeof document)return{};let e=document.cookie.match(/(?:^|; )auth_token=([^;]+)/);return e?{Authorization:"Bearer ".concat(decodeURIComponent(e[1]))}:{}},[]),[t,d]=o.useState([]),[l,a]=o.useState(""),[s,c]=o.useState(""),[u,p]=o.useState(""),[h,g]=o.useState(""),[f,x]=o.useState(""),[m,b]=o.useState(""),[v,y]=o.useState(""),[j,k]=o.useState(""),[C,w]=o.useState(""),T=e=>{w(e),setTimeout(()=>w(""),1800)},[_,S]=o.useState(!1);async function B(){if(!_){S(!0);try{let t={name:null==l?void 0:l.trim(),contactEmail:(null==s?void 0:s.trim())||null,phone:(null==u?void 0:u.trim())||null,address:(null==h?void 0:h.trim())||null,storeName:(null==f?void 0:f.trim())||null,storeNumber:(null==m?void 0:m.trim())||null,vendorCode:(null==v?void 0:v.trim())?v.trim().toUpperCase():null};if(!t.name){T("الاسم مطلوب");return}let n=await fetch("".concat(e,"/api/admin/vendors"),{method:"POST",headers:{"content-type":"application/json",...r()},credentials:"include",body:JSON.stringify(t)});if(!n.ok){let e="فشل حفظ المورد";try{let r=await n.json();(null==r?void 0:r.error)==="vendor_code_or_name_exists"?e="الاسم أو رمز المورد موجود مسبقاً":(null==r?void 0:r.message)&&(e=r.message)}catch(e){}T(e);return}a(""),c(""),p(""),g(""),x(""),b(""),y("");let o=await fetch("".concat(e,"/api/admin/vendors/list"),{credentials:"include",cache:"no-store",headers:{...r()}});if(!o.ok){T("فشل تحديث القائمة");return}let i=await o.json();d(i.vendors||[]),T("تمت الإضافة")}catch(e){console.error("vendor_save_error",e),T("خطأ غير متوقع")}finally{S(!1)}}}return o.useEffect(()=>{fetch("".concat(e,"/api/admin/vendors/list"),{credentials:"include",cache:"no-store",headers:{...r()}}).then(async e=>{if(!e.ok)throw Error("load_failed");return e.json()}).then(e=>d(e.vendors||[])).catch(e=>{console.error("vendors_list_failed",e),d([])})},[e]),(0,n.jsxs)("main",{style:{maxWidth:1200,margin:"0 auto",padding:16},children:[C&&(0,n.jsx)("div",{style:{marginBottom:8,background:"#111827",color:"#e5e7eb",padding:"6px 10px",borderRadius:8},children:C}),(0,n.jsx)("h1",{style:{marginBottom:16,fontSize:22,fontWeight:700},children:"المورّدون"}),(0,n.jsxs)("section",{style:{background:"#0b0e14",border:"1px solid #1c2333",borderRadius:12,padding:16,marginBottom:16},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,n.jsx)("h2",{style:{margin:0,fontSize:16},children:"إضافة مورد جديد"}),(0,n.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,n.jsx)("input",{value:j,onChange:e=>k(e.target.value),placeholder:"بحث بالاسم/الكود",style:{padding:8,borderRadius:8,background:"#0b0e14",border:"1px solid #1c2333",color:"#e2e8f0",width:220}}),(0,n.jsx)("button",{onClick:()=>{},style:{padding:"8px 12px",background:"#111827",color:"#e5e7eb",borderRadius:8},children:"بحث"})]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,n.jsx)("input",{value:l,onChange:e=>a(e.target.value),placeholder:"الاسم",style:{padding:10,borderRadius:10,background:"#0f1320",border:"1px solid #1c2333",color:"#e2e8f0"}}),(0,n.jsx)("input",{value:s,onChange:e=>c(e.target.value),placeholder:"البريد",style:{padding:10,borderRadius:10,background:"#0f1320",border:"1px solid #1c2333",color:"#e2e8f0"}}),(0,n.jsx)("input",{value:u,onChange:e=>p(e.target.value),placeholder:"الهاتف",style:{padding:10,borderRadius:10,background:"#0f1320",border:"1px solid #1c2333",color:"#e2e8f0"}}),(0,n.jsx)("input",{value:h,onChange:e=>g(e.target.value),placeholder:"العنوان",style:{padding:10,borderRadius:10,background:"#0f1320",border:"1px solid #1c2333",color:"#e2e8f0",gridColumn:"1 / -1"}})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,n.jsx)("input",{value:f,onChange:e=>x(e.target.value),placeholder:"اسم المتجر",style:{padding:10,borderRadius:10,background:"#0f1320",border:"1px solid #1c2333",color:"#e2e8f0"}}),(0,n.jsx)("input",{value:m,onChange:e=>b(e.target.value),placeholder:"رقم المتجر",style:{padding:10,borderRadius:10,background:"#0f1320",border:"1px solid #1c2333",color:"#e2e8f0"}}),(0,n.jsx)("input",{value:v,onChange:e=>y(e.target.value),placeholder:"رمز المورد (SKU prefix)",style:{padding:10,borderRadius:10,background:"#0f1320",border:"1px solid #1c2333",color:"#e2e8f0"}}),(0,n.jsx)("button",{onClick:B,disabled:_,style:{padding:"10px 14px",background:_?"#4b5563":"#800020",color:"#fff",borderRadius:10},children:_?"جارٍ الحفظ...":"إضافة"})]})]})]}),(0,n.jsx)("section",{style:{background:"#0b0e14",border:"1px solid #1c2333",borderRadius:12,padding:12,marginTop:16},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{textAlign:"right",borderBottom:"1px solid #1c2333",padding:12,background:"#0f1320"},children:"الاسم"}),(0,n.jsx)("th",{style:{textAlign:"right",borderBottom:"1px solid #1c2333",padding:12,background:"#0f1320"},children:"البريد"}),(0,n.jsx)("th",{style:{textAlign:"right",borderBottom:"1px solid #1c2333",padding:12,background:"#0f1320"},children:"الهاتف"}),(0,n.jsx)("th",{style:{textAlign:"right",borderBottom:"1px solid #1c2333",padding:12,background:"#0f1320"},children:"الكود"}),(0,n.jsx)("th",{style:{textAlign:"right",borderBottom:"1px solid #1c2333",padding:12,background:"#0f1320"},children:"إجراءات"})]})}),(0,n.jsx)("tbody",{children:t.filter(e=>{var r,t;return!j||(null===(r=e.name)||void 0===r?void 0:r.toLowerCase().includes(j.toLowerCase()))||(null===(t=e.vendorCode)||void 0===t?void 0:t.toLowerCase().includes(j.toLowerCase()))}).map((e,r)=>(0,n.jsxs)("tr",{style:{background:r%2?"#0a0e17":"transparent"},children:[(0,n.jsx)("td",{style:{padding:12,borderBottom:"1px solid #1c2333"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)("span",{style:{padding:"2px 8px",background:"#111827",borderRadius:999,fontSize:12,color:"#9ca3af"},children:e.vendorCode||"NO-CODE"}),(0,n.jsx)("span",{children:e.name})]})}),(0,n.jsx)("td",{style:{padding:12,borderBottom:"1px solid #1c2333"},children:e.contactEmail||"-"}),(0,n.jsx)("td",{style:{padding:12,borderBottom:"1px solid #1c2333"},children:e.phone||"-"}),(0,n.jsx)("td",{style:{padding:12,borderBottom:"1px solid #1c2333"},children:e.vendorCode||"-"}),(0,n.jsx)("td",{style:{padding:12,borderBottom:"1px solid #1c2333"},children:(0,n.jsx)("a",{href:"/vendors/".concat(e.id),style:{padding:"8px 12px",background:"#374151",color:"#e5e7eb",borderRadius:8,textDecoration:"none"},children:"عرض"})})]},e.id))})]})})]})}},5009:function(e,r,t){"use strict";var n,o;e.exports=(null==(n=t.g.process)?void 0:n.env)&&"object"==typeof(null==(o=t.g.process)?void 0:o.env)?t.g.process:t(4634)},4634:function(e){!function(){var r={229:function(e){var r,t,n,o=e.exports={};function i(){throw Error("setTimeout has not been defined")}function d(){throw Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{t="function"==typeof clearTimeout?clearTimeout:d}catch(e){t=d}}();var a=[],s=!1,c=-1;function u(){s&&n&&(s=!1,n.length?a=n.concat(a):c=-1,a.length&&p())}function p(){if(!s){var e=l(u);s=!0;for(var r=a.length;r;){for(n=a,a=[];++c<r;)n&&n[c].run();c=-1,r=a.length}n=null,s=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===d||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(r){try{return t.call(null,e)}catch(r){return t.call(this,e)}}}(e)}}function h(e,r){this.fun=e,this.array=r}function g(){}o.nextTick=function(e){var r=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];a.push(new h(e,r)),1!==a.length||s||l(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},t={};function n(e){var o=t[e];if(void 0!==o)return o.exports;var i=t[e]={exports:{}},d=!0;try{r[e](i,i.exports,n),d=!1}finally{d&&delete t[e]}return i.exports}n.ab="//";var o=n(229);e.exports=o}()}},function(e){e.O(0,[64,694,744],function(){return e(e.s=4499)}),_N_E=e.O()}]);